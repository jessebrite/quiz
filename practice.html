<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Higher Order Functions</title>
</head>
<body>
  <div id="main">
    <img src="" id="picture">
  </div>
</body>
</html>

<script>
  const companies = [
    {name: "Google", category: "Tech", start: 2005, end: "NA"},
    {name: 'Amazon', category: 'Tech', start: 1995, end: 'NA'},
    {name: 'Kojack', category: 'Pharmaceuticals', start: 2001, end: 2012},
    {name: 'Pusher', category: 'Beverages', start: 2005, end: 2010},
    {name: 'Apple', category: 'Tech', start: 1987, end: 'NA'},
    {name: 'Google', category: 'Tech', start: 2005, end: 'NA'},
    {name: 'ebay', category: 'ecommerce', start: 1998, end: 2016},
    {name: 'GT', category: 'Telecom', start: 1957, end: 2006},
    {name: 'Google', category: 'Tech', start: 2005, end: 'NA'},
   ];

  const ages = [9, 21, 17, 62, 31, 25, 16, 50, 4, 51, 41, 36, 33, 16];

  // ages.forEach(age => console.log(age));

  // companies.forEach(company => console.log(`Company: ${company.name}`));

   const canVote = ages.filter(a => a >= 18);
   // console.log(canVote);

   const tech = companies.filter(tech => tech.category === 'Tech');
   // console.log(tech);
   const stillActive = companies.filter(active => typeof(active.end) !== 'number');
   // console.log(stillActive);
   const lasted = companies.filter(lasted => (lasted.end - lasted.start) <= 10);
   // console.log(lasted);

   // square root of ages
   const sqrt = ages.map(age => Math.round(Math.sqrt(age)));
   // console.log(sqrt);

   const total = ages.reduce((total, age) => total + age, 0);
   // console.log(total);

   const agesLessThanTen = ages.filter(age => age < 10).reduce((total, age) => total + age, 0);
   // console.log(agesLessThanTen);

   function collatz(n, sequence=[n]) {
     if (n === 1) {
      return `Sequence took ${sequence.length} steps. It was ${sequence}`;
    }
    if (n % 2 === 0) {
      n = n / 2;
    } else {
      n = 3 * n + 1;
    }
    return collatz(n, [...sequence, n]);
   }

   // console.log(collatz(6));

  function power(x) {
    return function(power) {
      return Math.pow(x, power);
    }
  }

  const expTwo =  power(2);

  // console.log(expTwo(3), power(2)(3));

  const Human = {
    arms: 2,
    legs: 2,
    walk() { console.log('walking') }
  };

  const lois = Object.create(Human);

  lois.name = 'Lois Lane';
  lois.job = 'Reporter';

  const SuperHuman = Object.create(Human);

  SuperHuman.change = function() {
    return console.log(`${this.realName} goes in the phone booth and comes out as ${this.name}`);
  }

  SuperHuman.init = function(name = 'Fuck Boy', realName = 'Super Hero') {
    this.name = name;
    this.realName = realName;
    this.init = undefined;
    return this;
  }

  const batman = Object.create(SuperHuman);
  batman.init('BatMan', 'Bruce Wayne');
  batman.change();

  const superman = Object.create(SuperHuman).init('Superman', 'Clark Kent');
  superman.change();

  const wonderwoman = Object.create(SuperHuman).init('Wonder Woman');
  wonderwoman.change();

  const a = {};
  const b = {numbers: [1,2,3]};
  const c = {foo: 'bar'};
  mixin(a,b,c);

  console.log(`${a.numbers}\n${b.numbers}`);

  b.numbers.push(4);

  function mixin(target, ...objects) {
    for (const object of objects) {
      if (typeof object === 'object') {
        for (const key of Object.keys(object)) {
          if (typeof object[key] === 'object') {
            target[key] = Array.isArray(object[key]) ? [] : {};
            mixin(target[key],object[key]);
          } else {
            Object.assign(target, object);;
          }
        }
      }
    }
    return target;
  }

  function copy(target) {
    const object = Object.create(Object.getPrototypeOf(target));
    mixin(object, target);
    return object;
  }

  function createSuperHuman(...mixins) {
    const object = copy(SuperHuman);
    return mixin(object, ...mixins);
  }

  const flight = {
    fly() {
      console.log(`Up and away! ${this.name} can soar through the sky`);
      return this;
    }
  }
  const superSpeed = {
    move() {
      console.log(`${this.name} can move faster than a speeding bullet`);
      return this;
    }
  }

  const xRayVision = {
    xray() {
      console.log(`${this.name} can see right through you!`);
      return this;
    }
  }

  const strength = {
    strong() {
      console.log(`${this.name} can lift a bus with just one hand!`);
      return this;
    }
  }

  const aquaman = Object.create(SuperHuman);
  mixin(aquaman, {name: 'Aquaman', realName: 'Arthur Curry'});

  // aquaman.change();

  mixin(superman, flight, superSpeed, xRayVision, strength);
  mixin(wonderwoman, flight, strength);

  const bizzaro = copy(superman);
  // bizzaro.change();

  // bizzaro.name = 'Faya man';
  // bizzaro.change();
  // superman.change();
  // superman.superSpeed();
  // wonderwoman.fly()

  const hulk = createSuperHuman({name: 'Hulk', realName: 'Bruce Banner'});
  // hulk.change();

  const flash = createSuperHuman({name: 'Flash', realName: 'Barry Allen'}, superSpeed, flight);
  flash.change();
  // chaining methods
  // flash.move().fly();

  superman.friends = [batman, wonderwoman, aquaman, hulk];

  superman.findFriends = function() {
    this.friends.forEach(friend => {
      console.log(`${friend.name} is friends with ${this.name}`);
    });
  }

  superman.findFriends();

  console.log('\n');

  const proxy_url = "https://cors-anywhere.herokuapp.com/";
  const url = 'https://google.com';
  const pic = 'hng_img1.png';
  const request = new Request('https://google.com', {
        method: 'GET',
        mode: 'no-cors',
        redirect: 'follow',
        cache: 'no-cache'
      });
  // written in promise
  // fetch(proxy_url + url)
  //   .then(response => {
  //     if (response.ok)
  //       return response;
  //       throw Error(response.statusText);
  //   })
  //   .then(response => console.log(response))
  //   .catch(err => console.error('error found'));

  // written in async/ await
  async function getData() {
    const response = await fetch(request);
    const data = await response.blob();
    console.log(data);
  }

  getData().catch(err => {
    console.error(err);
  });

</script>
